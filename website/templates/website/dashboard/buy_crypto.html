{% extends "website/dashboard/base.html" %}

{% block title %}Buy Crypto â€“ BlockNova{% endblock %}
{% block page_title %}Buy Crypto{% endblock %}

{% block content %}

<!-- Messages -->
{% if messages %}
    {% for message in messages %}
        <div class="mb-4 p-3 rounded-lg text-white
            {% if message.tags == 'error' %}bg-red-500{% else %}bg-green-500{% endif %}">
            {{ message }}
        </div>
    {% endfor %}
{% endif %}

<!-- Buy Crypto Widget -->
<div class="w-full max-w-2xl mx-auto bg-white rounded-xl shadow p-6 sm:p-8">
    <h3 class="text-lg sm:text-xl font-bold text-blue-900 mb-6">
        Buy Cryptocurrency
    </h3>

    <p class="text-sm text-gray-600 mb-4">
        Payments are processed securely by Coinbase.
    </p>

    <!-- Launch Onramp -->
    <button id="buy-button"
            class="w-full bg-green-600 hover:bg-green-700 text-white py-3 rounded-lg font-bold transition">
        Continue to Coinbase Checkout
    </button>
</div>

<!-- Coinbase Onramp SDK -->
<script src="https://cdn.coinbase.com/onramp/v1/onramp.min.js"></script>
<script>
  const onramp = new CoinbaseOnramp({
    appId: "f3838bff-660e-4561-944d-a1226e0f8520",   
    destinationWallets: [
      { address: "0xYourWalletAddress", blockchains: ["base"] }
    ],
    defaultAsset: "USDC", 
    defaultFiat: "USD",
    redirectUrl: "{{ callback_url }}"  // Passed from your Django view
  });

  document.getElementById("buy-button").addEventListener("click", () => {
    onramp.open();
  });
</script>

{% endblock %}
